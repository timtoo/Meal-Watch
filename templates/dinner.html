{% extends "base.html" %}
{% block content %}

        <div class="col_33">
          <h2>Latest Meals</h2>
          <table class="table">
          <tbody>
          {% for meal in latest %}
          <tr id="lm-{{meal.id}}-{{meal.meal__id}}" class="atip">
            <td style="width:1%; white-space: nowrap">{{ meal.date|date:"M j (D.)" }}</span></td>
            <td>{% if meal.meal__foodtype__color %}<div class="circle" style="background-color: #{{meal.meal__foodtype__color}}"></div> {% endif %}{{ meal.meal__name|capfirst }}{% if meal.meal__common %}*{% endif %}</td>
          </tr>
          {% endfor %}

          </tbody>
          </table>
        </div>

        <div class="col_33">
          <h2>Most Popular Meals <span style="font-size: 60%">[1 year]</span></h2>
          <table class="table">
          <tbody>
          {% for meal in popular %}
          <tr id="pm-0-{{meal.id}}" class="atip">
            <td style="width:1%; white-space: nowrap; text-align: right">{{ meal.eaten__count }}</td>
            <td>{% if meal.foodtype__color %}<div class="circle" style="background-color: #{{meal.foodtype__color}}"></div> {% endif %}{{ meal.name|capfirst }}</td>
          </tr>
          {% endfor %}

          </tbody>
          </table>
        </div>

        <div class="col_33">
          <h2>It's been a while <span style="font-size: 60%">[common]</span></h2>
          <table class="table">
          <tbody>
          {% for meal in aging %}
          <tr id="am-0-{{meal.id}}" class="atip">
            <td style="width:1%; white-space: nowrap">{{ meal.last_eaten|default_if_none:"Never" }}</td>
            <td>{% if meal.foodtype__color %}<div class="circle" style="background-color: #{{meal.foodtype__color}}"></div> {% endif %}{{ meal.name|capfirst }}</td>
          </tr>
          {% endfor %}

          </tbody>
          </table>
        </div>

{% endblock %}

{% block bottom %}
<script>
$(document).ready(
    function() {

/*$(document).tooltip({
    items:'.atip',
    tooltipClass:'ttclass',
    track: true,
    content:function(callback) {
        $.get('../mealtip', {
            id:this.id
        }, function(data) {
            callback(data);
        });
    },
});*/

$('.atip').each( function() {
    console.log(this.id);
    $(this).qtip({
        content: { url: '../mealtip',  data: {id:this.id} },
        style: { name: 'blue', width: 250 },
        position: { target: 'mouse', adjust: { screen: true } }
    });
});


});


</script>
{% endblock %}

